<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Project 1</title>
  <link rel="stylesheet" href="style.css">
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      line-height: 1.6;
      background: linear-gradient(135deg, white, white); /* 和主页统一背景 */
      min-height: 100vh;
    }
    .image-item {
  text-align: center;      /* 水平居中 */
  margin: 20px auto;       /* 给整体加点上下间距 */
}

.image-item img {
  max-width: 100%;         /* 保证图片不会超出容器宽度 */
  height: auto;            /* 等比缩放 */
  display: inline-block;
}

.caption {
  font-size: 14px;
  color: #555;             /* 字体颜色略浅 */
  margin-top: 8px;         /* 图片和文字之间的间距 */
}


    /* 导航栏 */
    nav {
      width: 100%;
      background: linear-gradient(135deg, #6dd5fa, #2980b9);
      position: fixed;
      top: 0;
      left: 0;
      z-index: 100;
      padding: 0.8rem 0;
    }
    nav ul {
      display: flex;
      justify-content: space-around;
      align-items: center;
      list-style: none;
      margin: 0;
      padding: 0;
    }
    nav ul li a {
      text-decoration: none;
      color: white;
      font-weight: 600;
      font-size: 1rem;
      transition: color 0.3s ease;
    }
    nav ul li a:hover {
      color: #ffeaa7;
    }

    /* 内容主体 */
    .container {
      margin: 100px auto 40px auto; /* 避开导航栏 */
      padding: 0 15%;
    }
    h1 { text-align: center; color: darkgreen; }
    h2 { color: cadetblue; margin-top: 40px; }
    h3 { color: teal; margin-top: 20px; }
    p { color: #000; margin: 8px 0; }

    /* 图片展示区域 */
    .image-grid {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 20px;
      margin: 20px 0;
    }
    .image-item {
      text-align: center;
      max-width: 250px;
    }
    .image-item img {
      width: 100%;
      border-radius: 6px;
      border: 1px solid #ddd;
    }
    .caption {
      margin-top: 6px;
      font-size: 14px;
      color: #333;
      line-height: 1.4;
    }
  </style>
</head>
<body>

  <!-- 导航栏 -->
  <nav>
    <ul>
      <li><a href="index.html">Home</a></li>
      <li><a href="project0.html">Project 0</a></li>
      <li><a href="project1.html">Project 1</a></li>
    </ul>
  </nav>

  <!-- 页面主体内容 -->
  <div class="container">
    <h1>🎨 Project 1: Images of the Russian Empire -- Colorizing the Prokudin-Gorskii Photo Collection</h1>
    <div style="text-align: center; margin-bottom: 30px;">
      Name: <strong>Xiangru Huang</strong>
    </div>

    <!-- Overview -->
    <h2>Overview</h2>
    <p>
      This code implements a multi-scale image alignment algorithm to reconstruct a color image
      from three separate grayscale channels (blue, green, red) that may be misaligned due to capture artifacts.
      The algorithm uses a pyramid-based approach to efficiently align the green and red channels
      to the blue channel reference.
    </p>

    <!-- Algorithms -->
    <h2>Algorithms:</h2>
    <h3>1. Image Preparation</h3>
    <p>
      - The input image is split into three equal vertical segments representing the blue, green, and red channels.<br>
      - The blue channel is selected as the reference for alignment.
    </p>

    <h3>2. Alignment Metric</h3>
    <p>
      - Uses Normalized Cross-Correlation (NCC) of two images as the similarity measure:<br>
    </p>
    <p>
      $$ \text{NCC}(I_1, I_2) = \frac{I_1}{\|I_1\|} \cdot \frac{I_2}{\|I_2\|} $$
    </p>
    <div class="image-item">
      <img src="project1_images/unit_vectors_theta.gif">
      <div class="caption">illustration</div>
    </div>
    <p>
      The larger NCC is (i.e. the closer to 1), the more aligned two images are:
    </p>
    As illustrated in the gif, the dot product of two unit vectors approaches 1 if and only if they point in nearly the same direction.
In our context, the two normalized images that need to be aligned play the role of these unit vectors.
They are considered to be “in the same direction” when the increasing or decreasing trends of their values are consistent.
Because the absolute luminance (brightness) of each channel can vary greatly, we are not interested in the actual magnitude.
Instead, what matters is the tendency, whether both images rise or fall together.

    <h3>3. Image Pyramid</h3>
    <p>
      - Implements an image pyramid approach for efficient coarse-to-fine alignment.<br>
      - Recursively downsamples images to find approximate alignment at lower resolutions.<br>
    </p>

    <h3>4. Output</h3>
    <p>
      - Combines the aligned channels into a single color image.<br>
      - Saves and displays the aligned color image.
    </p>

    <!-- Results -->
    <h2>Results</h2>

    <h3>Low Resolution</h3>
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_cathedral.jpg">
        <div class="caption">cathedral<br>G to B (dx, dy): (5,2)<br>R to B (dx, dy): (12,3)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_monastery.jpg">
        <div class="caption">monastery<br>G to B (dx, dy): (-3,2)<br>R to B (dx, dy): (3,2)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_tobolsk.jpg">
        <div class="caption">tobolsk<br>G to B (dx, dy): (3,3)<br>R to B (dx, dy): (6,3)</div>
      </div>
    </div>

    <h3>High Resolution</h3>
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_emir.jpg">
        <div class="caption">emir<br>G to B (dx, dy): (49,24)<br>R to B (dx, dy): (107,40)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_church.jpg">
        <div class="caption">church<br>G to B (dx, dy): (25,4)<br>R to B (dx, dy): (58,-4)</div>
      </div>
    </div>

    <!-- 第二行：3 张 -->
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_harvesters.jpg">
        <div class="caption">harvesters<br>G to B (dx, dy): (60, 17)<br>R to B (dx, dy): (124, 14)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_icon.jpg">
        <div class="caption">icon<br>G to B (dx, dy): (42, 17)<br>R to B (dx, dy): (90, 23)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_italil.jpg">
        <div class="caption">italil<br>G to B (dx, dy): (38, 22)<br>R to B (dx, dy): (77, 36)</div>
      </div>
    </div>
    <!-- 第三行：3 张 -->
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_lastochikino.jpg">
        <div class="caption">lastochikino<br>G to B (dx, dy): (-3, -2)<br>R to B (dx, dy): (76, -8)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_lugano.jpg">
        <div class="caption">lugano<br>G to B (dx, dy): (41, -17)<br>R to B (dx, dy): (92, -29)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_melons.jpg" alt="highres8">
        <div class="caption">melons<br>G to B (dx, dy): (80, 10)<br>R to B (dx, dy): (177, 13)</div>
      </div>
    </div>

      <!-- 第四行：3 张 -->
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_self_portrait.jpg">
        <div class="caption">self_portrait<br>G to B (dx, dy): (78, 29)<br>R to B (dx, dy): (176, 37)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_siren.jpg">
        <div class="caption">siren<br>G to B (dx, dy): (49, -6)<br>R to B (dx, dy): (96, -24)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_three_generations.jpg">
        <div class="caption">three_generations<br>G to B (dx, dy): (54, 12)<br>R to B (dx, dy): (111, 9)</div>
      </div>
    </div>

      <h3>Additional Images:</h3>
      <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_captain.jpg">
        <div class="caption">captain<br>G to B (dx, dy): (63, 4)<br>R to B (dx, dy): (132, -4)</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_shabby.jpg">
        <div class="caption">shabby<br>G to B (dx, dy): (27, 9)<br>R to B (dx, dy): (70, 11)</div>
      </div>
          <div class="image-item">
        <img src="project1_images/out_path/out_sculpture.jpg">
        <div class="caption">sculpture<br>G to B (dx, dy): (24, -2)<br>R to B (dx, dy): (113, -2)</div>
      </div>
    </div>

    <!-- Problems -->
    <h2>Problems Encountered</h2>
    <p>
      Initially, the alignment results were poor because the algorithm did not crop images before comparison.
      The black borders introduced by shifting dominated the similarity metric, leading to incorrect alignment.
      After cropping (10%), accuracy improved significantly.
    </p>
    <div class="image-grid">
      <div class="image-item">
        <img src="project1_images/out_path/out_cathedral_without_crop.jpg">
        <div class="caption">cathedral without crop</div>
      </div>
      <div class="image-item">
        <img src="project1_images/out_path/out_cathedral.jpg">
        <div class="caption">cathedral with crop</div>
      </div>
    </div>
  </div>
</body>
</html>
